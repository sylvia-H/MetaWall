var V=Object.defineProperty,P=Object.defineProperties;var A=Object.getOwnPropertyDescriptors;var k=Object.getOwnPropertySymbols;var D=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var w=(t,s,i)=>s in t?V(t,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[s]=i,u=(t,s)=>{for(var i in s||(s={}))D.call(s,i)&&w(t,i,s[i]);if(k)for(var i of k(s))U.call(s,i)&&w(t,i,s[i]);return t},L=(t,s)=>P(t,A(s));import{_ as T,o as n,c as l,h as I,m,b as S,r as g,d as _,w as b,F as v,p as $,a as e,t as h,k as p,v as N,g as x,l as y}from"./index.dc3639a3.js";import{V as j}from"./LoadingOverlay.a8746287.js";import{u as O,s as z,p as C}from"./postStore.fbf06d71.js";const H={},K={class:"dialogue w-full border-2 border-secondary bg-white rounded-lg mb-4"},M=I('<div class="p-5 flex border-b-2 border-secondary"><span class="w-2.5 h-2.5 border border-brown-2 rounded-full bg-red-1 mr-1.5"></span><span class="w-2.5 h-2.5 border border-brown-2 rounded-full bg-yellow-1 mr-1.5"></span><span class="w-2.5 h-2.5 border border-brown-2 rounded-full bg-green-1"></span></div><div class="p-8"><p class="font-noto-sans-tc text-base text-brown-1 text-center"> \u76EE\u524D\u5C1A\u7121\u52D5\u614B </p></div>',2),F=[M];function R(t,s){return n(),l("div",K,F)}var nt=T(H,[["render",R]]);const W={components:{VueLoader:j},data(){return{commentBody:{},isEdit:""}},props:["authorID"],inject:["emitter"],computed:u(u(u({},m(O,["user"])),m(z,["isLoading"])),m(C,["posts"])),methods:L(u({},S(C,["getPosts"])),{addLikes(t){this.isLoading=!0;let s=`https://fierce-headland-11812.herokuapp.com/posts/${t._id}/like`,i;t.likes.includes(this.user._id)?i="DELETE":i="POST";const r=document.cookie.split("AUTH_TOKEN=").pop().split(";").shift();this.axios({method:i,url:s,headers:{Authorization:`Bearer ${r}`}}).then(()=>{this.isLoading=!1,this.getPosts("desc","",this.authorID,this.authorID==this.user._id)}).catch(d=>{this.isLoading=!1,console.dir(d)})},addComment(t){this.isLoading=!0;const s={article_id:t._id,author:this.user._id,comment:this.commentBody[t._id]},i="https://fierce-headland-11812.herokuapp.com/comments",r=document.cookie.split("AUTH_TOKEN=").pop().split(";").shift();this.axios({method:"POST",url:i,headers:{Authorization:`Bearer ${r}`},data:s}).then(()=>{this.isLoading=!1,this.getPosts("desc","",this.authorID,this.authorID==this.user._id)}).catch(d=>{this.isLoading=!1,console.dir(d)}),this.commentBody=""},setEditStatus(t){console.log(t),this.isEdit=t},delPost(t){const s=`https://fierce-headland-11812.herokuapp.com/posts/${t._id}`,i=document.cookie.split("AUTH_TOKEN=").pop().split(";").shift();this.$swal.fire({title:"\u78BA\u5B9A\u8981\u522A\u9664\u6B64\u7BC7\u8CBC\u6587\u55CE\uFF1F",text:"\u8CBC\u6587\u522A\u9664\u5F8C\u5C07\u7121\u6CD5\u6062\u5FA9\u3002",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"\u78BA\u5B9A\u522A\u9664\uFF01",cancelButtonText:"\u53D6\u6D88"}).then(r=>{r.isConfirmed&&(this.isLoading=!0,this.axios({method:"DELETE",url:s,headers:{Authorization:`Bearer ${i}`}}).then(()=>{this.isLoading=!1,this.getPosts("desc","",this.authorID,this.authorID==this.user._id)}).catch(d=>{this.isLoading=!1,this.$swal.fire({icon:"error",title:"\u5931\u6557\uFF01",text:"\u8ACB\u518D\u8A66\u4E00\u6B21"}),console.dir(d)}))})},uploadImg(t){this.isLoading=!0;let s="https://fierce-headland-11812.herokuapp.com/upload";const i=document.cookie.split("AUTH_TOKEN=").pop().split(";").shift();let r=new FormData;const d=t.target.files[0];r.append("file",d),this.axios({method:"POST",url:s,headers:{Authorization:`Bearer ${i}`},data:r}).then(c=>{this.isLoading=!1,this.errorMsg="",this.post.image=c.data.imgUrl}).catch(c=>{this.isLoading=!1,this.errorMsg=c.response.data.message})},editPost(t){let s=`https://fierce-headland-11812.herokuapp.com/posts/${t._id}`;const i=document.cookie.split("AUTH_TOKEN=").pop().split(";").shift(),r={content:t.content,image:t.image,privacy:t.privacy};this.axios({method:"PATCH",url:s,headers:{Authorization:`Bearer ${i}`},data:r}).then(()=>{this.isLoading=!1,this.getPosts("desc","","",!1)}).catch(d=>{this.isLoading=!1,console.dir(d)}),this.isEdit=""}})},q={class:"p-6"},G={class:"flex justify-between mb-4"},J={class:"flex"},Q={class:"h-11 w-11 border-2 border-secondary rounded-full overflow-hidden mr-2.5"},X=["src","alt"],Y={class:"font-noto-sans-tc font-bold text-base mb-1"},Z={class:"flex items-center"},ee={class:"font-baloo-da-2 text-sm text-brown-1 align-baseline mr-2"},te={key:0},oe=["onUpdate:modelValue"],se=e("option",{value:"private"},"\u53EA\u9650\u672C\u4EBA",-1),ie=e("option",{value:"public"},"\u516C\u958B",-1),ae=[se,ie],ne={key:1},le={key:0,class:"iconify block text-sm text-gray-500 align-top","data-icon":"bxs:lock"},de={key:1,class:"iconify block text-sm text-gray-500 align-top","data-icon":"eva:globe-2-fill"},re={key:0,type:"button"},ce={class:"group relative"},he=e("div",{class:"block group-hover:hidden group-focus:hidden"},[e("span",{class:"iconify text-2xl font-extrabold text-primary","data-icon":"clarity:note-edit-line"})],-1),ue=e("div",{class:"hidden group-hover:block group-focus:block"},[e("span",{class:"iconify text-2xl font-extrabold text-primary","data-icon":"bxs:edit"})],-1),_e={class:"absolute hidden group-hover:block w-30 py-3 top-6 left-0 shadow-lg rounded-lg bg-white z-50"},be={class:"w-full text-center"},pe=["onClick"],fe=["onClick"],me={key:0},ge=["onUpdate:modelValue"],ve={key:1,class:"font-noto-sans-tc text-base mb-4"},xe={key:0,class:"w-full h-40 border-2 border-secondary rounded-lg overflow-hidden mb-4"},ye=["src"],ke={key:1,class:"mb-4"},we={for:"uploadImg",class:"relative block mb-5"},Le=["onUpdate:modelValue"],$e={class:"flex justify-between"},Ce={for:"file",class:"relative mb-4 flex items-center justify-center text-white bg-black w-30 h-10"},Te=e("button",{type:"button",class:"whitespace-nowrap py-1 px-6"}," \u4E0A\u50B3\u5716\u7247\u6A94 ",-1),Ee=["onClick"],Be={class:"flex items-center mb-4"},Ve={key:0,class:"flex items-center"},Pe={class:"group mr-2"},Ae=e("button",{type:"button",class:"group-hover:hidden group-focus:hidden"},[e("span",{class:"iconify text-xl font-extrabold text-primary","data-icon":"bi:hand-thumbs-up"})],-1),De=["onClick"],Ue=e("span",{class:"iconify text-xl font-extrabold text-primary","data-icon":"bi:hand-thumbs-up-fill"},null,-1),Ie=[Ue],Se={class:"font-baloo-da-2 text-base text-secondary"},Ne={key:1,class:"flex items-center"},je=["onClick"],Oe=e("span",{class:"iconify text-xl font-extrabold text-brown-1","data-icon":"bi:hand-thumbs-up"},null,-1),ze=[Oe],He=e("span",{class:"font-baloo-da-2 text-base text-brown-1"}," \u6210\u70BA\u7B2C\u4E00\u500B\u6309\u8B9A\u7684\u670B\u53CB ",-1),Ke={class:"flex"},Me={class:"h-10 w-10 border-2 border-secondary rounded-full overflow-hidden mr-2.5"},Fe=["src","alt"],Re={class:"grow"},We={class:"input-group relative flex items-stretch w-full border-2 border-secondary"},qe=["onUpdate:modelValue"],Ge=["onClick"],Je={class:"flex"},Qe={class:"h-10 w-10 border-2 border-secondary rounded-full overflow-hidden mr-2.5"},Xe=["src","alt"],Ye={class:"font-noto-sans-tc font-bold text-base mb-1"},Ze={class:"font-baloo-da-2 text-xs text-brown-1 mb-1"},et={class:"font-noto-sans-tc text-base"};function tt(t,s,i,r,d,c){const E=g("VueLoader"),B=g("VLoading"),f=g("RouterLink");return n(),l(v,null,[_(B,{active:t.isLoading,"z-index":3e3},{default:b(()=>[_(E)]),_:1},8,["active"]),(n(!0),l(v,null,$(t.posts,o=>(n(),l("div",{key:o._id,class:"dialogue w-full border-2 border-secondary bg-white rounded-lg mb-4"},[e("div",q,[e("div",G,[e("div",J,[_(f,{to:`/main/space/${o.author._id}`},{default:b(()=>[e("div",Q,[e("img",{class:"object-cover w-full h-full",src:o.author.avatar,alt:`${o.author.name}'s avatar`},null,8,X)])]),_:2},1032,["to"]),e("div",null,[_(f,{to:`/main/space/${o.author._id}`},{default:b(()=>[e("p",Y,h(o.author.name),1)]),_:2},1032,["to"]),e("div",Z,[e("p",ee,h(t.$filters.transferToDate(o.createdAt)),1),d.isEdit===o._id?(n(),l("div",te,[p(e("select",{"onUpdate:modelValue":a=>o.privacy=a,class:"border border-secondary focus:border-indigo-300 text-sm"},ae,8,oe),[[N,o.privacy]])])):(n(),l("div",ne,[o.privacy==="private"?(n(),l("span",le)):(n(),l("span",de))]))])])]),o.author._id===t.user._id?(n(),l("button",re,[e("div",ce,[he,ue,e("div",_e,[e("ul",be,[e("li",{onClick:a=>d.isEdit=o._id,class:"hover:bg-gray-100 mb-2"}," \u7DE8\u8F2F\u8CBC\u6587 ",8,pe),e("li",{onClick:a=>c.delPost(o),class:"hover:bg-gray-100"}," \u522A\u9664\u8CBC\u6587 ",8,fe)])])])])):x("",!0)]),e("div",null,[d.isEdit===o._id?(n(),l("div",me,[p(e("textarea",{class:"mb-4 placeholder:italic placeholder:text-slate-400 block bg-white w-full border-2 border-secondary py-3 px-4 focus:outline-none focus:border-sky-500 focus:ring-sky-500 focus:ring-1",placeholder:"\u8F38\u5165\u60A8\u7684\u8CBC\u6587\u5167\u5BB9",name:"post",rows:"5","onUpdate:modelValue":a=>o.content=a},null,8,ge),[[y,o.content]])])):(n(),l("p",ve,h(o.content),1))]),o.image?(n(),l("div",xe,[e("img",{class:"object-cover w-full h-full",src:o.image,alt:"post image"},null,8,ye)])):x("",!0),d.isEdit===o._id?(n(),l("div",ke,[e("label",we,[p(e("input",{type:"text",name:"uploadImg",class:"p-2 placeholder:italic placeholder:text-slate-400 placeholder:text-sm w-full block bg-white border border-slate-300 rounded-md focus:outline-none focus:border-sky-500 focus:ring-sky-500 focus:ring-1","aria-label":"\u8ACB\u8F38\u5165\u5716\u7247\u7DB2\u5740\u6216\u4E0A\u50B3\u5716\u6A94",placeholder:"\u8ACB\u8F38\u5165\u5716\u7247\u9023\u7D50\u4F4D\u5740","onUpdate:modelValue":a=>o.image=a},null,8,Le),[[y,o.image]])]),e("div",$e,[e("label",Ce,[e("input",{onChange:s[0]||(s[0]=(...a)=>c.uploadImg&&c.uploadImg(...a)),type:"file",class:"absolute top-0 left-0 cursor-pointer opacity-0 w-full h-full"},null,32),Te]),e("button",{type:"button",onClick:a=>c.editPost(o),class:"bg-blue-600 text-white whitespace-nowrap py-1 px-6 w-30 h-10"}," \u5B8C\u6210\u7DE8\u8F2F ",8,Ee)])])):x("",!0),e("div",Be,[o.likes.length?(n(),l("div",Ve,[e("div",Pe,[Ae,e("button",{onClick:a=>c.addLikes(o),type:"button",class:"hidden group-hover:block group-focus:block"},Ie,8,De)]),e("span",Se,h(o.likes.length),1)])):(n(),l("div",Ne,[e("button",{onClick:a=>c.addLikes(o),type:"button",class:"group-hover:hidden group-focus:hidden mr-1"},ze,8,je),He]))]),e("div",Ke,[e("div",Me,[e("img",{class:"object-cover w-full h-full",src:t.user.avatar,alt:`${t.user.name}'s avatar`},null,8,Fe)]),e("div",Re,[e("div",We,[p(e("input",{"onUpdate:modelValue":a=>d.commentBody[o._id]=a,type:"text",class:"form-control relative flex-auto min-w-0 block w-full py-2 px-4 text-base font-bold text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none",placeholder:"\u7559\u8A00...","aria-label":"Comment","aria-describedby":"button-comment"},null,8,qe),[[y,d.commentBody[o._id]]]),e("button",{class:"btn w-32 px-4 py-2 bg-primary text-white border-l-2 border-secondary hover:bg-blue-700 hover:shadow-lg focus:bg-blue-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-blue-800 active:shadow-lg transition duration-150 ease-in-out",type:"button",id:"button-comment",onClick:a=>c.addComment(o)}," \u7559\u8A00 ",8,Ge)])])]),(n(!0),l(v,null,$(o.comments,a=>(n(),l("div",{key:a._id,class:"flex bg-gray-1 rounded-xl py-4.5 px-4 mt-4"},[e("div",Je,[e("div",Qe,[_(f,{to:`/main/space/${a.author._id}`},{default:b(()=>[e("img",{class:"object-cover w-full h-full",src:a.author.avatar,alt:`${a.author.name}'s avatar`},null,8,Xe)]),_:2},1032,["to"])]),e("div",null,[e("p",Ye,h(a.author.name||"\u66AB\u6642\u7121\u6CD5\u986F\u793A"),1),e("p",Ze,h(t.$filters.transferToDate(a.createdAt)),1),e("p",et,h(a.comment||"\u66AB\u6642\u7121\u6CD5\u986F\u793A"),1)])])]))),128))])]))),128))],64)}var lt=T(W,[["render",tt]]);export{nt as N,lt as W};
